{% extends "base.html" %}

{% block content %}
<div class="container">
    <h2>Update Inventory</h2>
    <form method="POST" action="{{ url_for('update_inventory') }}">
        {{ form.hidden_tag() }}
        <div class="form-group">
            {{ form.product.label(class="form-control-label") }}
            {{ form.product(class="form-control") }}
        </div>
        <div class="form-group">
            {{ form.quantity.label(class="form-control-label") }}
            {{ form.quantity(class="form-control") }}
        </div>
        <div class="form-group">
            {{ form.submit(class="btn btn-primary") }}
        </div>
    </form>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.0/socket.io.min.js"></script>
<script>
    const socket = io('/inventory');

    socket.on('connect', function() {
        console.log('Connected to server');
    });

    socket.on('inventory_update', function(data) {
        const row = document.querySelector(`tr[data-product-id="${data.product_id}"]`);
        if (row) {
            row.querySelector('.quantity').textContent = data.quantity;
        }
    });

    socket.on('disconnect', function() {
        console.log('Disconnected from server');
    });
</script>
{% endblock %}